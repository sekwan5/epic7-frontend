import{j as s,l as L,b as H,d as w,r as p,c as S,e as _,f as j,g as f,h as M}from"./index-DHxJYTwT.js";import{H as C,P as D}from"./HeroFilter-tx0Sv1xH.js";import{P as O}from"./ProfileImg-C1eAAHQz.js";import{C as k}from"./CoImages-vUrYe6KO.js";import{u as g,b as x}from"./hooks-CzQpnHU9.js";import{g as $}from"./getHeroData-AxyLBF-g.js";function N(o){const{data:a,useOption:e,handleDelete:l,usename:i=!0}=o,n="https://raw.githubusercontent.com/sekwan5/epic7-assets/main/";return s.jsxs("div",{className:"hero-icon",children:[s.jsxs("div",{className:"icon-wrap",children:[s.jsx(k,{className:"icon",src:`${n}/job/${a.job_id}.png`,alt:"job",width:30,height:30}),s.jsx(k,{className:"icon",src:`${n}/type/${a.type_id}.png`,alt:"type",width:30,height:30})]}),s.jsx(O,{id:a.id}),e&&s.jsxs("div",{className:"option-wrap",children:[a.isLock?s.jsx("i",{className:"ico-lock"}):s.jsx("div",{}),s.jsx("i",{className:"ico-hero-delete",onClick:u=>{u.stopPropagation(),l&&l(a)}})]}),i&&s.jsx("span",{className:"hero-name",children:a.name})]})}function v(o){const{data:a,setData:e,tab:l}=o,i=g();if(a.length<1)return null;const n=c=>{switch(l){case 0:{const r=a.map(t=>t.id===c.id?{...t,campPick:!0}:t);e(r),i(H(c));break}case 1:{const r=a.map(t=>t.id===c.id?{...t,isLock:!t.isLock}:t);e(r),i(L(c));break}}},u=c=>{const r=a.map(t=>t.id===c.id?{...t,campPick:!1}:t);e(r),i(w(c))};return s.jsx("div",{className:"camping-content-wrap",children:s.jsx("div",{className:"hero-icon-grid",children:a.map(c=>l===0&&(!c.isShow||c.campPick)||l===1&&(!c.isShow||!c.campPick)||!c.isShow?null:s.jsx("div",{className:"hero-icon-wrap",onClick:()=>n(c),children:s.jsx(N,{data:c,useOption:l===1,handleDelete:u})},c.id))})})}function A(o){const{setTab:a,tab:e}=o,l=x(i=>i.camp.campBookMarkList.length);return s.jsxs("div",{className:"camping-tab-wrap",children:[s.jsx("div",{className:`camping-tab-wrap-item ${e===0?"active":""}`,onClick:()=>a(0),children:s.jsx("i",{className:"ico ico-add_hero color-gray }"})}),s.jsx("div",{className:`camping-tab-wrap-item ${e===1?"active":""}`,onClick:()=>a(1),children:s.jsx("i",{className:"ico ico-edit_hero color-gray "})}),s.jsx("div",{className:`camping-tab-wrap-item ${e===2?"active":""}`,onClick:()=>a(2),children:s.jsx("i",{className:"ico ico-camp color-gray"})}),s.jsxs("div",{className:`camping-tab-wrap-item ${e===3?"active":""}`,onClick:()=>a(3),children:[s.jsx("i",{className:"ico ico-camp-save color-gray"}),l>0&&s.jsx("span",{className:"bookmark-count",children:l})]})]})}function B(o){const{data:a=[],useBookMark:e=!0}=o,l=g(),[i,n]=p.useState(15),u=()=>{n(t=>t+15)},c=t=>{l(S(t))},r=t=>{l(_(t))};return s.jsxs("div",{children:[s.jsxs("table",{className:"camping-result-table table-borderless",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"col-1"}),s.jsx("th",{className:"col-5 text-align-center",style:{maxWidth:"340px"},children:"편성"}),s.jsx("th",{className:"col-4 col-xl-5",children:"선택지"}),s.jsx("th",{children:"사기"})]})}),s.jsx("tbody",{children:a.length>0&&a.slice(0,i).map((t,d)=>s.jsxs("tr",{className:"",children:[s.jsx("td",{className:"align-middle",children:s.jsxs("div",{className:"index-cell d-flex align align-items-center justify-content-center gap-2",children:[s.jsx("span",{children:d+1}),e?s.jsx("i",{className:"ico ico-camp-save color-gray",onClick:()=>{c(t)}}):s.jsx("i",{className:"ico ico-trash color-gray",onClick:()=>{r(t)}})]})}),s.jsx("td",{className:"d-flex team",children:t.team.map(m=>s.jsx("div",{style:{width:"70px",padding:"5px 0px"},children:s.jsx(N,{data:m,usename:!1})},m.id))}),s.jsxs("td",{className:"al-c fw-light",children:[`${t.bestChatOption1.hero.name} : ${t.bestChatOption1.option_kr}`,s.jsx("br",{}),`${t.bestChatOption2.hero.name} : ${t.bestChatOption2.option_kr}`]}),s.jsx("td",{className:"al-c",children:t.score})]},d))})]}),i<a.length&&s.jsx("div",{className:"load-more-container",children:s.jsx("button",{onClick:u,className:"load-more-button",children:"더보기"})})]})}function E(o){const a={},e=Array.isArray(o)?o:[-1,-1];for(let l=0;l<b.topics.length;l++){const i=b.topics[l];a[i.name]=Math.max(i.values[e[0]]||0,0)+Math.max(i.values[e[1]]||0,0)}return a}function P(o){const a=(i,n)=>{const u=[];return n===1?i.map(c=>[c]):(i.forEach((c,r,t)=>{const d=t.slice(r+1),h=a(d,n-1).map(y=>[c,...y]);u.push(...h)}),u)},e=o.filter(i=>i.isLock),l=o.filter(i=>!i.isLock);if(e.length>=4)return[e.slice(0,4)];{const i=4-e.length;return a(l,i).map(u=>[...e,...u])}}function I(o){const a=[];o.forEach(n=>{a.push({option_en:n.camping.topics_en[0],option_kr:n.camping.topics_kr[0],hero:n,score:0}),a.push({option_en:n.camping.topics_en[1],option_kr:n.camping.topics_kr[1],hero:n,score:0})}),a.forEach(n=>{let u=0;o.forEach(c=>{u+=c.camping.campValue[n.option_en]}),u-=n.hero.camping.campValue[n.option_en],n.score=u}),a.sort(R);const e=new Set,l=a.filter(n=>e.has(n.option_en)?!1:(e.add(n.option_en),!0));return{team:o,bestChatOption1:l[0],bestChatOption2:l[1],score:l[0].score+l[1].score}}function R(o,a){return a.score-o.score}const b={personalities:["Introvert","Hot and Cold","Cherub","Narcissist","Arrogant","Debate Addict","Academic","Heroism","Traumatized","Loyal","Realistic","Selfish","Individualistic","Altruistic","Glutton","Alcoholic","Lovesick","Lustful","Psychopath","Religious","Optimistic","Pessimistic","Indifferent","Natural","Obsessive","Hard Worker","Extrovert","Envious","Cool-Headed","Free","Escapist"],topics:[{name:"Criticism",values:[-1,-2,-2,3,5,5,2,-5,3,-1,3,3,2,-3,null,2,null,null,3,-3,-2,3,0,-2,0,2,0,3,2,1,2]},{name:"Reality Check",values:[-3,0,-2,3,-3,3,2,-3,-3,1,3,0,2,-3,null,-2,null,null,2,0,-2,3,0,-2,-3,1,0,0,2,-1,-3]},{name:"Heroic Tale",values:[1,0,2,3,5,-3,0,3,1,3,-1,0,0,-3,null,3,null,null,-3,0,3,-2,1,2,0,2,3,2,0,0,-1]},{name:"Comforting Cheer",values:[3,3,2,5,3,0,1,3,-3,3,0,0,2,3,null,3,null,null,3,3,0,5,0,2,-1,5,3,-2,-2,1,3]},{name:"Cute Cheer",values:[3,3,2,5,4,0,1,1,1,1,1,1,1,3,null,2,null,null,0,0,3,-3,1,2,1,2,3,2,0,2,2]},{name:"Heroic Cheer",values:[3,0,2,3,-3,1,1,3,0,5,2,0,2,2,null,3,null,null,-3,2,3,-1,0,2,1,2,3,3,0,1,-3]},{name:"Sad Memory",values:[0,3,2,0,0,-3,0,3,3,3,0,0,1,5,null,1,null,null,4,4,1,-2,0,2,-3,3,-2,-1,0,1,3]},{name:"Joyful Memory",values:[2,2,2,0,0,0,0,3,3,2,0,2,3,3,null,2,null,null,0,2,4,1,1,2,0,3,3,1,1,1,3]},{name:"Happy Memories",values:[2,2,2,0,2,0,0,3,0,2,0,0,2,3,null,1,null,null,-2,2,2,1,0,2,-1,-3,2,1,0,1,2]},{name:"Unique Comment",values:[0,1,0,2,0,-1,-3,2,3,0,0,0,0,0,null,1,null,null,5,2,3,-1,1,0,3,0,0,1,3,2,1]},{name:"Self-Indulgent",values:[-3,-3,2,0,-3,1,5,-1,1,-2,-1,-2,0,-2,null,2,null,null,1,0,1,-2,0,2,-1,-3,2,2,0,1,-2]},{name:"Occult",values:[0,0,-1,-3,3,-3,3,0,3,-2,-1,0,0,-1,null,-2,null,null,3,-3,1,4,0,-1,1,0,1,2,0,1,2]},{name:"Myth",values:[1,0,2,2,5,3,5,3,0,1,-1,0,0,1,null,0,null,null,-3,3,1,-3,0,2,0,0,1,4,0,1,-3]},{name:"Bizarre Story",values:[2,0,-1,-3,-3,-3,0,-2,-2,-1,-2,0,-2,-1,null,-2,null,null,5,-2,1,3,0,-1,5,0,2,0,0,2,-2]},{name:"Food Story",values:[0,0,4,0,3,0,0,2,0,2,0,0,1,0,null,3,null,null,-3,1,3,-2,4,4,0,3,1,2,0,1,2]},{name:"Horror Story",values:[-1,-2,-5,-3,-2,0,-5,2,0,0,2,3,0,-2,null,-3,null,null,5,0,1,-2,-2,-5,3,-1,3,0,0,1,-2]},{name:"Gossip",values:[3,1,1,1,-1,3,2,-2,-3,-3,1,3,-2,1,null,0,null,null,-3,-1,1,-3,0,1,0,-3,2,0,0,1,1]},{name:"Dream",values:[1,2,2,2,0,2,0,2,2,1,-3,0,2,3,null,2,null,null,2,2,2,0,0,2,2,3,2,3,0,4,0]},{name:"Advice",values:[3,1,1,2,3,3,1,2,-2,2,2,0,2,5,null,3,null,null,3,2,0,0,0,1,2,2,2,-2,0,1,2]},{name:"Complain",values:[-3,-1,1,-2,-2,2,1,-3,-3,-1,0,3,2,1,null,2,null,null,-5,2,1,-2,0,1,-5,-5,0,-2,0,1,2]},{name:"Belief",values:[3,0,0,4,-3,-1,0,-1,5,-3,2,3,1,-3,0,3,0,0,3,3,2,-3,0,1,3,1,1,3,0,-1,-3]},{name:"Interesting Story",values:[2,1,1,1,-1,1,2,1,1,0,-1,0,1,1,null,3,null,null,1,0,2,1,1,1,0,1,2,1,1,5,3]}]};function T(o){const{tab:a}=o,e=g(),{campingHeroList:l,campResultList:i,campBookMarkList:n}=x(r=>r.camp),u=p.useCallback(r=>{if(r.camping&&r.camping.personalities){const t=E(r.camping.personalities);return{...r,camping:{...r.camping,campValue:t}}}else return console.warn(`Missing camping data for hero: ${r.name}`),r},[]),c=p.useCallback(async()=>{if(l.length>=4){const r=await Promise.all(l.map(async m=>{try{return u(m)}catch(h){return console.error(`Error processing camping data for hero: ${m.name}`,h),m}})),d=P(r).map(m=>I(m));d.sort((m,h)=>h.score-m.score),e(j(d))}else e(j([]))},[l,u,e]);return p.useEffect(()=>{a===2&&c()},[]),s.jsx("div",{className:"camping-content-wrap",children:s.jsx("div",{className:"results-container",children:s.jsx(B,{data:a===2?i:n,useBookMark:a===2})})})}function F(){const o=g(),{heroList:a}=x(u=>u.camp),[e,l]=p.useState(0);p.useEffect(()=>{a.length<1&&i()},[a.length]);const i=p.useCallback(()=>{const c=$().map(r=>({...r,isShow:!0}));o(f(c)),o(M())},[o]),n=p.useCallback(u=>{o(f(u))},[o]);return s.jsxs("div",{className:"hero-list",children:[s.jsx(A,{setTab:l,tab:e}),e===0&&s.jsxs(s.Fragment,{children:[s.jsx(C,{data:a,setData:n}),s.jsx(v,{data:a,setData:n,tab:0})]}),e===1&&s.jsxs(s.Fragment,{children:[s.jsx(C,{data:a,setData:n}),s.jsx(v,{data:a,setData:n,tab:1})]}),e>1&&s.jsx(T,{tab:e})]})}function q(){return s.jsx("div",{className:"container",children:s.jsxs("div",{className:"hero-list-wrap",children:[s.jsx(D,{children:s.jsx("h2",{children:"미궁 시뮬레이터"})}),s.jsx(F,{})]})})}function K(){return s.jsx(q,{})}export{K as Component};
